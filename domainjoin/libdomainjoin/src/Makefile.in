BUILD_ROOT = ../..

SHELL= /bin/sh
VPATH= @srcdir@

subdirs= @subdirs@
top_srcdir= @top_srcdir@
srcdir = @srcdir@
prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = ${exec_prefix}/bin
infodir = ${prefix}/info
libdir = @libdir@
mandir = ${prefix}/man/man1

DESTDIR=@DESTDIR@
CC = @CC@
CPPFLAGS = @CPPFLAGS@
CFLAGS = $(CPPFLAGS) @CFLAGS@ -Wall
LDFLAGS = @LDFLAGS@
LIBS = @CENTUTILS_LIBS@ @LIBS@
INSTALL = @INSTALL@
LWI_OS_FLAGS = @LWI_OS_FLAGS@
LIBVER_MAJOR = @LIBVER_MAJOR@
SHLIBVEXT = @SHLIBVEXT@

PUBLIC_INCLUDE_DIR = $(BUILD_ROOT)/include
PROJECT_INCLUDE_DIR = ../include

CFLAGS += -I$(PUBLIC_INCLUDE_DIR)       \
          -I$(PROJECT_INCLUDE_DIR)      \
          @CENTUTILS_CPPFLAGS@                 \
          @LIBXML2_CPPFLAGS@                 \
          $(LWI_OS_FLAGS)

SCRIPTDIR = $(bindir)
CFLAGS += -DSCRIPTDIR=\"$(SCRIPTDIR)\" -DLIBDIR=\"$(libdir)\"

LDFLAGS += @CENTUTILS_LDFLAGS@ @LIBXML2_LDFLAGS@

OBJS = djauthinfo.o   \
       djauthconf.o   \
       djhostinfo.o   \
       djkrb5conf.o   \
       djlogger.o     \
       djlogincfg.o   \
       djmethodcfg.o  \
       djpamconf.o    \
       djdistroinfo.o \
       djsshconf.o    \
       djstr.o    \
       djnsswitch.o    \
       djparsehosts.o \
       djprocutils.o  \
       djroutines.o   \
       djsecuser.o    \
       djfirewall.o    \
       djtimemgmt.o \
       djmodule.o \
       djdaemonmgr.o \
       djsystemscripts.o \
       djaixparser.o \
       djconfig_mac.o \
       djapi.o

OBJS += @LIBDOMAINJOIN_OS_SPECIFIC_OBJECTS@

LIBNAME = domainjoin
LIBRARY = lib$(LIBNAME).a
SHLIBRARY = lib$(LIBNAME)@SHLIBVEXT@
SHLIBRARY_SANS_VERSION = lib$(LIBNAME)@SHLIBEXT@

all : $(SHLIBRARY)

$(SHLIBRARY) : $(LIBRARY)
	@BUILD_SHLIB_CMD@
	$(RM) $(SHLIBRARY_SANS_VERSION)
	@LINK@ $(SHLIBRARY) $(SHLIBRARY_SANS_VERSION)

$(LIBRARY) : $(OBJS)
	$(AR) -r $@ $(OBJS)

$(OBJS) : %.o : %.c
	$(CC) -c $(CFLAGS) $< -o $@

clean :
	$(RM) $(OBJS) $(LIBRARY) $(SHLIBRARY) $(SHLIBRARY_SANS_VERSION)

distclean: clean
	$(RM) Makefile

install: all
	$(top_srcdir)/mkinstalldirs $(DESTDIR)/$(bindir)
	$(top_srcdir)/mkinstalldirs $(DESTDIR)/$(libdir)

uninstall:

