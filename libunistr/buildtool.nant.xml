<?xml version="1.0"?>
<project>
  <target name="local.build">
    <cl outputdir="${build.meta.current}/">
      <includedirs>
        <include name="include"/>
      </includedirs>
      <sources>
	<include name="lib/*.c"/>
      </sources>
      <defines>
        <define name="UNICODE"/>
        <define name="_UNICODE"/>
        <define name="WIN32"/>
        <define name="_WINDOWS"/>
        <define name="NDEBUG"/>
        <define name="_USRDLL"/>
        <define name="LIBUNISTR_EXPORTS"/>
        <define name="LIBUNISTRVCPROJ_EXPORTS"/>
      </defines>
	<arg line="/O2 /GL /FD /EHsc /Wp64 /Zi /MD /W3" />
    </cl>
    <link output="${build.meta.current}/libunistr.dll" options="/dll">
      <sources basedir="${build.meta.current}/">
        <include name="*.obj"/>
      </sources>
    </link>
    <exec program="mt.exe">
        <arg line="-manifest libunistr.dll.manifest -outputresource:${build.meta.current}/libunistr.dll;2" />
    </exec>
    <copy todir="${build.dist.os}">
      <fileset basedir="${build.meta.current}">
	<include name="*.dll"/>
	<include name="*.exe"/>
      </fileset>
    </copy>
  </target>
</project>
