<html lang="en">
<head>
<title>Upgrading to Kerberos V5 from Kerberos V4</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Upgrading to Kerberos V5 from Kerberos V4">
<meta name="generator" content="makeinfo 4.7">
<link title="Top" rel="top" href="#Top">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc { font-variant:small-caps }
  span.roman { font-family: serif; font-weight: normal; } 
--></style>
</head>
<body>
<h1 class="settitle">Upgrading to Kerberos V5 from Kerberos V4</h1>
<div class="node">
<p><hr>
<a name="Top"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Copyright">Copyright</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#dir">(dir)</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dir">(dir)</a>
<br>
</div>

<ul class="menu">
<li><a accesskey="1" href="#Copyright">Copyright</a>
<li><a accesskey="2" href="#Introduction">Introduction</a>
<li><a accesskey="3" href="#Configuration-Files">Configuration Files</a>
<li><a accesskey="4" href="#Upgrading-KDCs">Upgrading KDCs</a>
<li><a accesskey="5" href="#Upgrading-Application-Servers">Upgrading Application Servers</a>
<li><a accesskey="6" href="#Upgrading-Client-machines">Upgrading Client machines</a>
<li><a accesskey="7" href="#Firewall-Considerations">Firewall Considerations</a>
</ul>

<div class="node">
<p><hr>
<a name="Copyright"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Introduction">Introduction</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="unnumbered">Copyright</h2>

<p>Copyright &copy; 1985-2007 by the Massachusetts Institute of Technology.

<blockquote>
Export of software employing encryption from the United States of
America may require a specific license from the United States
Government.  It is the responsibility of any person or organization
contemplating export to obtain such a license before exporting. 
</blockquote>

<p>WITHIN THAT CONSTRAINT, permission to use, copy, modify, and distribute
this software and its documentation for any purpose and without fee is
hereby granted, provided that the above copyright notice appear in all
copies and that both that copyright notice and this permission notice
appear in supporting documentation, and that the name of M.I.T. not be
used in advertising or publicity pertaining to distribution of the
software without specific, written prior permission.  Furthermore if you
modify this software you must label your software as modified software
and not distribute it in such a fashion that it might be confused with
the original MIT software.  M.I.T. makes no representations about the
suitability of this software for any purpose.  It is provided &ldquo;as is&rdquo;
without express or implied warranty.

<p>Individual source code files are copyright MIT, Cygnus Support,
Novell, OpenVision Technologies, Oracle, Red Hat, Sun Microsystems,
FundsXpress, and others.

<p>Project Athena, Athena, Athena MUSE, Discuss, Hesiod, Kerberos, Moira,
and Zephyr are trademarks of the Massachusetts Institute of Technology
(MIT).  No commercial use of these trademarks may be made without
prior written permission of MIT.

<p>&ldquo;Commercial use&rdquo; means use of a name in a product or other for-profit
manner.  It does NOT prevent a commercial firm from referring to the
MIT trademarks in order to convey information (although in doing so,
recognition of their trademark status should be given).

<p>The following copyright and permission notice applies to the
OpenVision Kerberos Administration system located in
<code>kadmin/create</code>, <code>kadmin/dbutil</code>, <code>kadmin/passwd</code>,
<code>kadmin/server</code>, <code>lib/kadm5</code>, and portions of
<code>lib/rpc</code>:

<blockquote>
Copyright, OpenVision Technologies, Inc., 1996, All Rights Reserved

     <p>WARNING:  Retrieving the OpenVision Kerberos Administration system source
code, as described below, indicates your acceptance of the following
terms.  If you do not agree to the following terms, do not retrieve the
OpenVision Kerberos administration system.

     <p>You may freely use and distribute the Source Code and Object Code
compiled from it, with or without modification, but this Source Code is
provided to you &ldquo;AS IS&rdquo; EXCLUSIVE OF ANY WARRANTY, INCLUDING, WITHOUT
LIMITATION, ANY WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A
PARTICULAR PURPOSE, OR ANY OTHER WARRANTY, WHETHER EXPRESS OR IMPLIED. 
IN NO EVENT WILL OPENVISION HAVE ANY LIABILITY FOR ANY LOST PROFITS,
LOSS OF DATA OR COSTS OF PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES, OR
FOR ANY SPECIAL, INDIRECT, OR CONSEQUENTIAL DAMAGES ARISING OUT OF THIS
AGREEMENT, INCLUDING, WITHOUT LIMITATION, THOSE RESULTING FROM THE USE
OF THE SOURCE CODE, OR THE FAILURE OF THE SOURCE CODE TO PERFORM, OR FOR
ANY OTHER REASON.

     <p>OpenVision retains all copyrights in the donated Source Code. OpenVision
also retains copyright to derivative works of the Source Code, whether
created by OpenVision or by a third party. The OpenVision copyright
notice must be preserved if derivative works are made based on the
donated Source Code.

     <p>OpenVision Technologies, Inc. has donated this Kerberos Administration
system to MIT for inclusion in the standard Kerberos 5 distribution. 
This donation underscores our commitment to continuing Kerberos
technology development and our gratitude for the valuable work which has
been performed by MIT and the Kerberos community. 
</blockquote>

<blockquote>
Portions contributed by Matt Crawford <code>&lt;crawdad@fnal.gov&gt;</code> were work
performed at Fermi National Accelerator Laboratory, which is operated
by Universities Research Association, Inc., under contract
DE-AC02-76CHO3000 with the U.S. Department of Energy. 
</blockquote>

<p>Portions of <code>src/lib/crypto</code> have the following copyright:

<blockquote>
Copyright &copy; 1998 by the FundsXpress, INC.

     <p>All rights reserved.

     <p>Export of this software from the United States of America may require
a specific license from the United States Government.  It is the
responsibility of any person or organization contemplating export to
obtain such a license before exporting.

     <p>WITHIN THAT CONSTRAINT, permission to use, copy, modify, and
distribute this software and its documentation for any purpose and
without fee is hereby granted, provided that the above copyright
notice appear in all copies and that both that copyright notice and
this permission notice appear in supporting documentation, and that
the name of FundsXpress. not be used in advertising or publicity pertaining
to distribution of the software without specific, written prior
permission.  FundsXpress makes no representations about the suitability of
this software for any purpose.  It is provided &ldquo;as is&rdquo; without express
or implied warranty.

     <p>THIS SOFTWARE IS PROVIDED &ldquo;AS IS&rdquo; AND WITHOUT ANY EXPRESS OR
IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED
WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.

</blockquote>

<p>The implementation of the Yarrow pseudo-random number generator
in <code>src/lib/crypto/yarrow</code> has the following copyright:

<blockquote>
Copyright 2000 by Zero-Knowledge Systems, Inc.

     <p>Permission to use, copy, modify, distribute, and sell this software
and its documentation for any purpose is hereby granted without fee,
provided that the above copyright notice appear in all copies and that
both that copyright notice and this permission notice appear in
supporting documentation, and that the name of Zero-Knowledge Systems,
Inc. not be used in advertising or publicity pertaining to
distribution of the software without specific, written prior
permission.  Zero-Knowledge Systems, Inc. makes no representations
about the suitability of this software for any purpose.  It is
provided &ldquo;as is&rdquo; without express or implied warranty.

     <p>ZERO-KNOWLEDGE SYSTEMS, INC. DISCLAIMS ALL WARRANTIES WITH REGARD TO
THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS, IN NO EVENT SHALL ZERO-KNOWLEDGE SYSTEMS, INC. BE LIABLE FOR
ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTUOUS ACTION, ARISING OUT
OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. 
</blockquote>

<p>The implementation of the AES encryption algorithm in
<code>src/lib/crypto/aes</code> has the following copyright:

<blockquote>
Copyright &copy; 2001, Dr Brian Gladman <code>&lt;brg@gladman.uk.net&gt;</code>,
Worcester, UK.<br>
All rights reserved.

     <p>LICENSE TERMS

     <p>The free distribution and use of this software in both source and binary
form is allowed (with or without changes) provided that:

          <ol type=1 start=1>
<li>distributions of this source code include the above copyright
notice, this list of conditions and the following disclaimer;
<li>distributions in binary form include the above copyright
notice, this list of conditions and the following disclaimer
in the documentation and/or other associated materials;
<li>the copyright holder's name is not used to endorse products
built using this software without specific written permission.
          </ol>

     <p>DISCLAIMER

     <p>This software is provided 'as is' with no explcit or implied warranties
in respect of any properties, including, but not limited to, correctness
and fitness for purpose. 
</blockquote>

<p>Portions contributed by Red Hat, including the pre-authentication
plug-in framework, contain the following copyright:

<blockquote>
Copyright &copy; 2006 Red Hat, Inc.<br>
Portions copyright &copy; 2006 Massachusetts Institute of Technology<br>
All Rights Reserved.<br>

     <p>Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

          <ul>
<li>Redistributions of source code must retain the above copyright
notice, this list of conditions and the following disclaimer. 
<li>Redistributions in binary form must reproduce the above copyright
notice, this list of conditions and the following disclaimer in the
documentation and/or other materials provided with the distribution. 
<li>Neither the name of Red Hat, Inc., nor the names of its contributors
may be used to endorse or promote products derived from this software
without specific prior written permission. 
</ul>

     <p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &ldquo;AS
IS&rdquo; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER
OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

</blockquote>

<p>The implementations of GSSAPI mechglue in GSSAPI-SPNEGO in
<code>src/lib/gssapi</code>, including the following files:

<pre class="smallexample">     lib/gssapi/generic/gssapi_err_generic.et
     lib/gssapi/mechglue/g_accept_sec_context.c
     lib/gssapi/mechglue/g_acquire_cred.c
     lib/gssapi/mechglue/g_canon_name.c
     lib/gssapi/mechglue/g_compare_name.c
     lib/gssapi/mechglue/g_context_time.c
     lib/gssapi/mechglue/g_delete_sec_context.c
     lib/gssapi/mechglue/g_dsp_name.c
     lib/gssapi/mechglue/g_dsp_status.c
     lib/gssapi/mechglue/g_dup_name.c
     lib/gssapi/mechglue/g_exp_sec_context.c
     lib/gssapi/mechglue/g_export_name.c
     lib/gssapi/mechglue/g_glue.c
     lib/gssapi/mechglue/g_imp_name.c
     lib/gssapi/mechglue/g_imp_sec_context.c
     lib/gssapi/mechglue/g_init_sec_context.c
     lib/gssapi/mechglue/g_initialize.c
     lib/gssapi/mechglue/g_inquire_context.c
     lib/gssapi/mechglue/g_inquire_cred.c
     lib/gssapi/mechglue/g_inquire_names.c
     lib/gssapi/mechglue/g_process_context.c
     lib/gssapi/mechglue/g_rel_buffer.c
     lib/gssapi/mechglue/g_rel_cred.c
     lib/gssapi/mechglue/g_rel_name.c
     lib/gssapi/mechglue/g_rel_oid_set.c
     lib/gssapi/mechglue/g_seal.c
     lib/gssapi/mechglue/g_sign.c
     lib/gssapi/mechglue/g_store_cred.c
     lib/gssapi/mechglue/g_unseal.c
     lib/gssapi/mechglue/g_userok.c
     lib/gssapi/mechglue/g_utils.c
     lib/gssapi/mechglue/g_verify.c
     lib/gssapi/mechglue/gssd_pname_to_uid.c
     lib/gssapi/mechglue/mglueP.h
     lib/gssapi/mechglue/oid_ops.c
     lib/gssapi/spnego/gssapiP_spnego.h
     lib/gssapi/spnego/spnego_mech.c
</pre>
<p>are subject to the following license:

<blockquote>
Copyright &copy; 2004 Sun Microsystems, Inc.

     <p>Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the
&ldquo;Software&rdquo;), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

     <p>The above copyright notice and this permission notice shall be included
in all copies or substantial portions of the Software.

     <p>THE SOFTWARE IS PROVIDED &ldquo;AS IS&rdquo;, WITHOUT WARRANTY OF ANY KIND, EXPRESS
OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. 
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. 
</blockquote>

<p>Kerberos V5 includes documentation and software developed at the
University of California at Berkeley, which includes this copyright
notice:

<blockquote>
Copyright &copy; 1983 Regents of the University of California.<br>
All rights reserved.

     <p>Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:
          <ol type=1 start=1>
<li>Redistributions of source code must retain the above copyright
notice, this list of conditions and the following disclaimer. 
<li>Redistributions in binary form must reproduce the above copyright
notice, this list of conditions and the following disclaimer in the
documentation and/or other materials provided with the distribution. 
<li>Neither the name of the University nor the names of its contributors
may be used to endorse or promote products derived from this software
without specific prior written permission.
          </ol>

     <p>THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS &ldquo;AS IS&rdquo; AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
SUCH DAMAGE. 
</blockquote>

<p>Portions contributed by Novell, Inc., including the LDAP database
backend, are subject to the following license:

<blockquote>
Copyright (c) 2004-2005, Novell, Inc. 
All rights reserved.

     <p>Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

          <ul>
<li>Redistributions of source code must retain the above copyright notice,
this list of conditions and the following disclaimer. 
<li>Redistributions in binary form must reproduce the above copyright
notice, this list of conditions and the following disclaimer in the
documentation and/or other materials provided with the distribution. 
<li>The copyright holder's name is not used to endorse or promote products
derived from this software without specific prior written permission. 
</ul>

     <p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &ldquo;AS IS&rdquo;
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE. 
</blockquote>

<p>Portions funded by Sandia National Laboratory
and developed by the University of Michigan's
Center for Information Technology Integration,
including the PKINIT implementation, are subject
to the following license:

<blockquote>

     <p>COPYRIGHT &copy; 2006-2007<br>
THE REGENTS OF THE UNIVERSITY OF MICHIGAN<br>
ALL RIGHTS RESERVED

     <p>Permission is granted to use, copy, create derivative works
and redistribute this software and such derivative works
for any purpose, so long as the name of The University of
Michigan is not used in any advertising or publicity
pertaining to the use of distribution of this software
without specific, written prior authorization.  If the
above copyright notice or any other identification of the
University of Michigan is included in any copy of any
portion of this software, then the disclaimer below must
also be included.

     <p>THIS SOFTWARE IS PROVIDED AS IS, WITHOUT REPRESENTATION
FROM THE UNIVERSITY OF MICHIGAN AS TO ITS FITNESS FOR ANY
PURPOSE, AND WITHOUT WARRANTY BY THE UNIVERSITY OF
MICHIGAN OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING
WITHOUT LIMITATION THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE
REGENTS OF THE UNIVERSITY OF MICHIGAN SHALL NOT BE LIABLE
FOR ANY DAMAGES, INCLUDING SPECIAL, INDIRECT, INCIDENTAL, OR
CONSEQUENTIAL DAMAGES, WITH RESPECT TO ANY CLAIM ARISING
OUT OF OR IN CONNECTION WITH THE USE OF THE SOFTWARE, EVEN
IF IT HAS BEEN OR IS HEREAFTER ADVISED OF THE POSSIBILITY OF
SUCH DAMAGES. 
</blockquote>

<p>The pkcs11.h file included in the PKINIT code has the
following license:

<blockquote>

     <p>Copyright 2006 g10 Code GmbH
Copyright 2006 Andreas Jellinghaus

     <p>This file is free software; as a special exception the author gives
unlimited permission to copy and/or distribute it, with or without
modifications, as long as this notice is preserved.

     <p>This file is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY, to the extent permitted by law; without even
the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
PURPOSE.

</blockquote>

<p>Permission is granted to make and distribute verbatim copies of this
manual provided the copyright notices and this permission notice are
preserved on all copies.

<p>Permission is granted to copy and distribute modified versions of this
manual under the conditions for verbatim copying, provided also that the
entire resulting derived work is distributed under the terms of a
permission notice identical to this one.

<p>Permission is granted to copy and distribute translations of this manual
into another language, under the above conditions for modified versions.

<div class="node">
<p><hr>
<a name="Introduction"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Configuration-Files">Configuration Files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Copyright">Copyright</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">1 Introduction</h2>

<p>As with most software upgrades, Kerberos V5 is generally backward
compatible but not necessarily forward compatible.  The Kerberos V5
daemons can interoperate with Kerberos V4 clients, but most of the
Kerberos V4 daemons can not interoperate with Kerberos V5 clients.  This
suggests the following strategy for performing the upgrade:

     <ol type=1 start=1>
<li><strong>Upgrade your KDCs.</strong>  This must be done first, so that
interactions with the Kerberos database, whether by Kerberos V5 clients
or by Kerberos V4 clients, will succeed.

     <li><strong>Upgrade your servers.</strong>  This must be done before upgrading
client machines, so that the servers are able to respond to both
Kerberos V5 and Kerberos V4 queries.

     <li><strong>Upgrade your client machines.</strong>  Do this only after your KDCs and
application servers are upgraded, so that all of your Kerberos V5
clients will be talking to Kerberos V5 daemons.
     </ol>

<div class="node">
<p><hr>
<a name="Configuration-Files"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Upgrading-KDCs">Upgrading KDCs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Introduction">Introduction</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">2 Configuration Files</h2>

<p>The Kerberos <code>krb5.conf</code> and KDC <code>kdc.conf</code> configuration
files allow additional tags for Kerberos V4 compatibility.

<ul class="menu">
<li><a accesskey="1" href="#krb5_002econf">krb5.conf</a>
<li><a accesskey="2" href="#kdc_002econf">kdc.conf</a>
</ul>

<div class="node">
<p><hr>
<a name="krb5_002econf"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#kdc_002econf">kdc.conf</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Configuration-Files">Configuration Files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Configuration-Files">Configuration Files</a>
<br>
</div>

<h3 class="section">2.1 krb5.conf</h3>

<p>If you used the defaults, both when you installed Kerberos V4 and when
you installed Kerberos V5, you should not need to include any of
these tags.  However, some or all of them may be necessary for
nonstandard installations.

<ul class="menu">
<li><a accesskey="1" href="#libdefaults">libdefaults</a>
<li><a accesskey="2" href="#realms-_0028krb5_002econf_0029">realms (krb5.conf)</a>
<li><a accesskey="3" href="#AFS-and-the-Appdefaults-Section">AFS and the Appdefaults Section</a>
</ul>

<div class="node">
<p><hr>
<a name="libdefaults"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#realms-_0028krb5_002econf_0029">realms (krb5.conf)</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#krb5_002econf">krb5.conf</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#krb5_002econf">krb5.conf</a>
<br>
</div>

<h4 class="subsection">2.1.1 [libdefaults]</h4>

<p>In the [libdefaults] section, the following additional tags may be used:

     <dl>
<dt><b>krb4_srvtab</b><dd>Specifies the location of the Kerberos V4 srvtab file.  Default is
/etc/srvtab.

     <br><dt><b>krb4_config</b><dd>Specifies the location of the Kerberos V4 configuration file.  Default
is /etc/krb.conf.

     <br><dt><b>krb4_realms</b><dd>Specifies the location of the Kerberos V4 domain/realm translation
file.  Default is /etc/krb.realms. 
</dl>

<div class="node">
<p><hr>
<a name="realms-_0028krb5_002econf_0029"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#AFS-and-the-Appdefaults-Section">AFS and the Appdefaults Section</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#libdefaults">libdefaults</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#krb5_002econf">krb5.conf</a>
<br>
</div>

<h4 class="subsection">2.1.2 [realms]</h4>

<p>In the [realms] section, the following Kerberos V4 tags may be used:
     <dl>
<dt><b>default_domain</b><dd>Identifies the default domain for hosts in this realm.  This is needed
for translating V4 principal names (which do not contain a domain name)
to V5 principal names.  The default is your Kerberos realm name,
converted to lower case.

     <dt><b>v4_instance_convert</b><dd>This subsection allows the administrator to configure exceptions to the
default_domain mapping rule.  It contains V4 instances (tag name) which
should be translated to some specific hostname (tag value) as the second
component in a Kerberos V5 principal name.

     <dt><b>v4_realm</b><dd>This relation allows the administrator to configure a different
realm name to be used when converting V5 principals to V4
ones.  This should only be used when running separate V4 and V5
realms, with some external means of password sychronization
between the realms.

</dl>

<div class="node">
<p><hr>
<a name="AFS-and-the-Appdefaults-Section"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#realms-_0028krb5_002econf_0029">realms (krb5.conf)</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#krb5_002econf">krb5.conf</a>
<br>
</div>

<h4 class="subsection">2.1.3 AFS and the Appdefaults Section</h4>

<p>Many Kerberos 4 sites also run the Andrew File System (AFS).

<p>Modern AFS servers (OpenAFS &gt; 1.2.8) support the AFS 2b token format. 
This allows AFS to use Kerberos 5 tickets rather than version 4
tickets, enabling cross-realm authentication.  By default, the
<span class="file">krb524d</span> service will issue the new AFS 2b tokens.  If you are
using old AFS servers, you will need to disable these new tokens. 
Please see the documentation of the <code>appdefaults</code> section of
<span class="file">krb5.conf</span> in the Kerberos Administration guide.

<div class="node">
<p><hr>
<a name="kdc_002econf"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#krb5_002econf">krb5.conf</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Configuration-Files">Configuration Files</a>
<br>
</div>

<h3 class="section">2.2 kdc.conf</h3>

<p>Because Kerberos V4 requires a different type of salt for the encryption
type, you will need to change the <code>supported_enctypes</code> line in the
[realms] section to:

<pre class="smallexample">     supported_enctypes = des-cbc-crc:normal des-cbc-crc:v4
</pre>
<p>This is the only change needed to the <code>kdc.conf</code> file.

<div class="node">
<p><hr>
<a name="Upgrading-KDCs"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Upgrading-Application-Servers">Upgrading Application Servers</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Configuration-Files">Configuration Files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">3 Upgrading KDCs</h2>

<p>To convert your KDCs from Kerberos V4 to Kerberos V5, do the
following:

     <ol type=1 start=1>
<li>Install Kerberos V5 on each KDC, according to the instructions in
the Kerberos V5 Installation Guide, up to the point where it tells
you to create the database.

     <li>Find the <code>kadmind</code> (V4) daemon process on the master KDC and kill
it.  This will prevent changes to the Kerberos database while you
convert the database to the new Kerberos V5 format.

     <li>Create a dump of the V4 database in the directory where your V5 database
will reside by issuing the command:

     <pre class="smallexample">          % kdb_util dump /usr/local/var/krb5kdc/v4-dump
     </pre>
     <li>Load the V4 dump into a Kerberos V5 database, by issuing the command:

     <pre class="smallexample">          % kdb5_util load_v4 v4-dump
     </pre>
     <li>Create a Kerberos V5 stash file, if desired, by issuing the command:

     <pre class="smallexample">          % kdb5_util stash
     </pre>
     <li>Proceed with the rest of the Kerberos V5 installation as described
in the Kerberos V5 Installation Guide.  When you get to the section
that tells you to start the <code>krb5kdc</code> and <code>kadmind</code> daemons,
first find and kill the Kerberos V4 <code>kerberos</code> daemon on each of
the KDCs.  Then start the <code>krb5kdc</code> and <code>kadmind</code> daemons as
You will need to specify an argument to the <code>-4</code> command line option to enable Kerberos 4 compatibility. 
See the <code>krb5kdc</code> man page for details. 
directed.  Finally, start the Kerberos V5 to V4 ticket translator
daemon, <code>krb524d</code>, by issuing the command:

     <pre class="smallexample">          % /usr/local/sbin/krb524d -m &gt; /dev/null &amp;
     </pre>
     <p>If you have a stash file and you start the <code>krb5kdc</code> and
<code>kadmind</code> daemons at boot time, you should add the above line to
your <code>/etc/rc</code> (or <code>/etc/rc.local</code>) file on each KDC.
     </ol>

<div class="node">
<p><hr>
<a name="Upgrading-Application-Servers"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Upgrading-Client-machines">Upgrading Client machines</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Upgrading-KDCs">Upgrading KDCs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">4 Upgrading Application Servers</h2>

<p>Install Kerberos V5 on each application server, according to the
instructions in the Kerberos V5 Installation Guide, with the
following exceptions:

     <ul>
<li>In the file <code>/etc/services</code>, add or edit the lines described in the
Kerberos V5 Installation Guide, with the following exception:

     <p>in place of:

     <pre class="smallexample">          kerberos      88/udp    kdc    # Kerberos V5 KDC
          kerberos      88/tcp    kdc    # Kerberos V5 KDC
     </pre>
     <p class="noindent">add instead:

     <pre class="smallexample">          kerberos-sec  88/udp    kdc    # Kerberos V5 KDC
          kerberos-sec  88/tcp    kdc    # Kerberos V5 KDC
     </pre>
     <li>Convert your Kerberos V4 srvtab file to Kerberos V5 keytab file as
follows:

     <pre class="smallexample">          <b>#</b> /usr/local/sbin/ktutil
          <b>ktutil:</b>  rst /etc/krb-srvtab
          <b>ktutil:</b>  wkt /etc/krb5.keytab
          <b>ktutil:</b>  q
          <b>#</b>
     </pre>
     </ul>

<div class="node">
<p><hr>
<a name="Upgrading-Client-machines"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Firewall-Considerations">Firewall Considerations</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Upgrading-Application-Servers">Upgrading Application Servers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">5 Upgrading Client machines</h2>

<p>Install Kerberos V5 on each client machine, according to the
instructions in the Kerberos V5 Installation Guide.

<p>Tell your users to add the appropriate directory to their paths.  On
UNIX machines, this will probably be <code>/usr/local/bin</code>.

<p>Note that if you upgrade your client machines before all of your
application servers are upgraded, your users will need to use the
Kerberos V4 programs to connect to application servers that are still
running Kerberos V4.  (The one exception is the UNIX version of
Kerberos V5 telnet, which can connect to a Kerberos V4 and Kerberos
V5 application servers.)  Users can use either the Kerberos V4 or
Kerberos V5 programs to connect to Kerberos V5 servers.

<div class="node">
<p><hr>
<a name="Firewall-Considerations"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Upgrading-Client-machines">Upgrading Client machines</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">6 Firewall Considerations</h2>

<p>Kerberos V5 uses port 88, which is the port
assigned by the IETF, for KDC requests.  Kerberos V4 used port
750.  If your users will need to get to any KDCs
outside your firewall, you will need to allow TCP and UDP requests on
port 88 for your users to get to off-site Kerberos V5
KDCs, and on port 750 for your users to get to
off-site Kerberos V4 KDCs.

<div class="contents">
<h2>Table of Contents</h2>
<ul>
<li><a name="toc_Copyright" href="#Copyright">Copyright</a>
<li><a name="toc_Introduction" href="#Introduction">1 Introduction</a>
<li><a name="toc_Configuration-Files" href="#Configuration-Files">2 Configuration Files</a>
<ul>
<li><a href="#krb5_002econf">2.1 krb5.conf</a>
<ul>
<li><a href="#libdefaults">2.1.1 [libdefaults]</a>
<li><a href="#realms-_0028krb5_002econf_0029">2.1.2 [realms]</a>
<li><a href="#AFS-and-the-Appdefaults-Section">2.1.3 AFS and the Appdefaults Section</a>
</li></ul>
<li><a href="#kdc_002econf">2.2 kdc.conf</a>
</li></ul>
<li><a name="toc_Upgrading-KDCs" href="#Upgrading-KDCs">3 Upgrading KDCs</a>
<li><a name="toc_Upgrading-Application-Servers" href="#Upgrading-Application-Servers">4 Upgrading Application Servers</a>
<li><a name="toc_Upgrading-Client-machines" href="#Upgrading-Client-machines">5 Upgrading Client machines</a>
<li><a name="toc_Firewall-Considerations" href="#Firewall-Considerations">6 Firewall Considerations</a>
</li></ul>
</div>

<!-- second page break makes sure right-left page alignment works right -->
<!-- with a one-page toc, even though we don't have setchapternewpage odd. -->
<!-- end of texinfo file -->
</body></html>

