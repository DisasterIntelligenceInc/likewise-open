DSAPI Methods for vmdirdb provider:

*VmdirDbOpen - 
*VmdirDbBind -
*VmdirDbAddObject - 
 VmdirDbModifyObject - 
*VmdirDbSetPassword - 
 VmdirDbChangePassword - 
 VmdirDbVerifyPassword - 
 VmdirDbGetGroupMembers -
 VmdirDbGetUserMemberships -
 VmdirDbAddToGroup -
 VmdirDbRemoveFromGroup -
 VmdirDbDeleteObject -
 VmdirDbSearchObject -
 VmdirDbGetUserCount -
 VmdirDbGetGroupCount -
*VmdirDbClose -  

Note: *Initially, most of these methods are stubbed out. Methods marked with a * will be implemented.

DSAPI Plugin API Methods
SamDbOpen
SamDbBind
SamDbAddObject
SamDbModifyObject
SamDbSetPassword
SamDbChangePassword
SamDbVerifyPassword
SamDbGetGroupMembers
SamDbGetUserMemberships
SamDbAddToGroup
SamDbRemoveFromGroup
SamDbDeleteObject
SamDbSearchObject
SamDbGetUserCount
SamDbGetGroupCount
SamDbClose

VmdirDbOpen
VmdirDbBind
VmdirDbAddObject                    : ldap_add / ldap_add_ext
VmdirDbModifyObject                 : ldap_modify
VmdirDbSetPassword                  : ldap_passwd
VmdirDbChangePassword               : ldap_passwd
VmdirDbVerifyPassword
VmdirDbGetGroupMembers
VmdirDbGetUserMemberships
VmdirDbAddToGroup
VmdirDbRemoveFromGroup
VmdirDbDeleteObject                 : ldap_delete
VmdirDbSearchObject                 : ldap_search (ldap_search_ext)
VmdirDbGetUserCount
VmdirDbGetGroupCount
VmdirDbClose


samdb Plugin types to vmdirdb (ldap) types translation
                               objectClass = ->
    SAMDB_OBJECT_CLASS_UNKNOWN         = 0,
    SAMDB_OBJECT_CLASS_DOMAIN          = 1,  -> (???) ou=Domain Controllers,dc=lightwave,dc=local
    SAMDB_OBJECT_CLASS_BUILTIN_DOMAIN  = 2,  -> Search base = "cn=builtin,dc=lightwave,dc=local"
    SAMDB_OBJECT_CLASS_CONTAINER       = 3,  -> container
    SAMDB_OBJECT_CLASS_LOCAL_GROUP     = 4,
    SAMDB_OBJECT_CLASS_USER            = 5,  -> user
    SAMDB_OBJECT_CLASS_LOCALGRP_MEMBER = 6,

logindata="-D "CN=Administrator,CN=Users,DC=lightwave,DC=local" -H ldap://10.118.97.57  -w VMware123@"

# List everything
#                     Base                     Filter  attributes
ldapsearch $logindata -b dc=lightwave,dc=local '(cn=*)' + - '*'  \

# List SAMDB_OBJECT_CLASS_DOMAIN        = 1:  -> (???) ou=Domain Controllers,dc=lightwave,dc=local
ldapsearch $logindata -b "ou=Domain Controllers,dc=lightwave,dc=local" '(cn=*)' cn  objectSid \

#List SAMDB_OBJECT_CLASS_BUILTIN_DOMAIN = 2:
ldapsearch $logindata -b cn=builtin,dc=lightwave,dc=local '(cn=*)' cn  objectSid \

# List SAMDB_OBJECT_CLASS_CONTAINER = 3:
ldapsearch $logindata "(&(objectClass=container)(cn=*))" cn  \

# List SAMDB_OBJECT_CLASS_USER = 5:
ldapsearch $logindata -b dc=lightwave,dc=local '(cn=*)' cn   \


==============================================
# Breakpoints regex
grep '\.pfn' samdbinit.c | sed -e 's/.*= &//' -e 's/,//' -e 's/^/b /'
grep '\.pfn' vmdirdbinit.c | sed -e 's/.*= &//' -e 's/,//' -e 's/^/b /'


int ldap_add_ext(
       LDAP *ld,
       const char *dn,
       LDAPMod **attrs,
       LDAPControl **sctrls,
       LDAPControl **cctrls,
       int *msgidp );

#if LDAP_DEPRECATED
LDAP_F( int )
ldap_add LDAP_P((       /* deprecated, use ldap_add_ext */
        LDAP *ld,
        LDAP_CONST char *dn,
        LDAPMod **attrs ));




b SamrSrvEnumDomains
b SamrSrvLookupDomain

b VmdirDbSearchObject
b SamDbSearchObject




b SamDbOpen
b SamDbBind
b SamDbAddObject
b SamDbModifyObject
b SamDbSetPassword
b SamDbChangePassword
b SamDbVerifyPassword
b SamDbGetGroupMembers
b SamDbGetUserMemberships
b SamDbAddToGroup
b SamDbRemoveFromGroup
b SamDbDeleteObject
b SamDbSearchObject
b SamDbGetUserCount
b SamDbGetGroupCount
b SamDbClose


b VmdirDbOpen
b VmdirDbBind
b VmdirDbAddObject
b VmdirDbModifyObject
b VmdirDbSetPassword
b VmdirDbChangePassword
b VmdirDbVerifyPassword
b VmdirDbGetGroupMembers
b VmdirDbGetUserMemberships
b VmdirDbAddToGroup
b VmdirDbRemoveFromGroup
b VmdirDbDeleteObject
b VmdirDbSearchObject
b VmdirDbGetUserCount
b VmdirDbGetGroupCount
b VmdirDbClose



db) x/hs pDirectoryEntries[0].pAttributes [0].pwszName
0x64b490:       u"CommonName"
(gdb) x/hs pDirectoryEntries[0].pAttributes [0].pValues.data.pwszStringValue
0x6637e0:       u"PHOTON-102-TEST"

(gdb) x/hs pDirectoryEntries[0].pAttributes [1].pwszName
0x663810:       u"ObjectSID"
(gdb) x/hs pDirectoryEntries[0].pAttributes [1].pValues.data.pwszStringValue
0x661210:       u"S-1-5-21-2863089035-1413825318-3321153934"


(gdb) x/hs pDirectoryEntries[1].pAttributes [0].pwszName
0x661270:       u"CommonName"
(gdb) x/hs pDirectoryEntries[1].pAttributes [0].pValues.data.pwszStringValue
0x661310:       u"BUILTIN"

(gdb) x/hs pDirectoryEntries[1].pAttributes [1].pwszName
0x663cd0:       u"ObjectSID"
(gdb) x/hs pDirectoryEntries[1].pAttributes [1].pValues.data.pwszStringValue
0x661350:       u"S-1-5-32"
~                                 
