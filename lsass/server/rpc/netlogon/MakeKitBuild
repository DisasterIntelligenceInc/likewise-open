make()
{
    NETLOGON_SOURCES="\
        globals.c                        \
	netlogon_cfg.c                   \
	netlogon_srv.c                   \
	netlogon_memory.c                \
	netlogonldap_config.c            \
	netlogonldap_utils.c             \
	netlogonldapopen.c               \
	netlogonldapglobals.c            \
	netlogonldap_ldap.c              \
        "

    lw_dceidl \
	IDL=../../../idl/netlogon.idl \
	IDLFLAGS="-cstub_pref cli_ -sstub_pref srv_" \
	INCLUDEDIRS=". ../../../include" \
	HEADER="netlogon_h.h" \
	SSTUB="netlogon_sstub.c" \
	HEADERDEPS="lw/base.h"

    mk_group \
	GROUP=netlogon_stub \
	SOURCES="netlogon_sstub.c" \
	CPPFLAGS="-DDCERPC_STUB_BUILD" \
	INCLUDEDIRS=". ../../../include" \
	HEADERDEPS="dce/rpc.h" \
	LIBDEPS="dcerpc"

    mk_dlo \
	DLO=libnetlogon_srv \
	SOURCES="netlogon.c $NETLOGON_SOURCES" \
        CPPFLAGS="-DLW_ENABLE_THREADS=1 -DLDAP_DEPRECATED=1" \
	GROUPS="netlogon_stub" \
	INCLUDEDIRS=". ../../include ../../api ../../../include" \
	HEADERDEPS="dce/rpc.h lw/base.h lwio/lwio.h lwnet.h lwadvapi.h uuid/uuid.h openssl/md4.h" \
	LIBDEPS="dsapi lsaserverapi lwnetclientapi lwadvapi crypto" \
	DEPS="netlogon_h.h"

    mk_program \
        PROGRAM="netlogon_test" \
        SOURCES="netlogon_test.c netlogon.c $NETLOGON_SOURCES" \
        INSTALLDIR="${MK_BINDIR}" \
        CPPFLAGS="-D_NETLOGON_UNIT_TEST -DLW_ENABLE_THREADS=1 -DLDAP_DEPRECATED=1" \
	GROUPS="netlogon_stub" \
	INCLUDEDIRS=". ../../include ../../api ../../../include" \
	HEADERDEPS="dce/rpc.h lw/base.h lwio/lwio.h lwnet.h lwadvapi.h uuid/uuid.h openssl/md4.h" \
	LIBDEPS="dsapi lsaserverapi lwnetclientapi lwadvapi regclient rsutils lwadvapi_nothr lwbase lwbase_nothr uuid crypto ldap_r lber dcerpc $LIB_PTHREAD $LIB_DL" \
	DEPS="netlogon_h.h"

    mk_program \
        PROGRAM="netlogon_test2" \
        SOURCES="netlogon_test2.c netlogon.c $NETLOGON_SOURCES" \
        INSTALLDIR="${MK_BINDIR}" \
        CPPFLAGS="-D_NETLOGON_UNIT_TEST -DLW_ENABLE_THREADS=1 -DLDAP_DEPRECATED=1" \
	GROUPS="netlogon_stub" \
	INCLUDEDIRS=". ../../include ../../api ../../../include" \
	HEADERDEPS="dce/rpc.h lw/base.h lwio/lwio.h lwnet.h lwadvapi.h uuid/uuid.h openssl/md4.h" \
	LIBDEPS="dsapi lsaserverapi lwnetclientapi lwadvapi regclient rsutils lwadvapi_nothr lwbase lwbase_nothr uuid crypto ldap_r lber dcerpc $LIB_PTHREAD $LIB_DL" \
	DEPS="netlogon_h.h"
}
