#!/bin/bash

function usage
{
    echo "usage: `basename $0` query"
}

function GetSettingLine
{
    local line=`grep -P "^[ \\t]*${1}[ \\t]*=[ \\t]*\\S+[ \\t]*\$" /etc/samba/lwiauthd.conf | tail -1`
    # rc=$?
    # if [ $rc -ne 0 ]; then
    #     exit $rc
    # fi

    # if [ -z "${line}" ]; then
    #     echo "${1} info not found!"
    #     return 1
    # fi

    echo "${line}"
    return 0
}

case "$1" in
    query)
        workgroupLine=`GetSettingLine workgroup`
        realmLine=`GetSettingLine realm`
        echo "protocol = 2.1"
        echo "${workgroupLine}"
        echo "${realmLine}"
        ;;
    *)
        usage
        exit 1
esac

exit 0
